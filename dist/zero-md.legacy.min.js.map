{"version":3,"file":"zero-md.legacy.min.js","sources":["../src/utils/IDfy.js","../src/index.js"],"sourcesContent":["const notAUnicodeWord =\n  /[^_0-9a-zA-Z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+/g\n\nexport default function IDfy(\n  name,\n  options = { lowerCase: true, replace: { its: notAUnicodeWord, with: '-' } },\n) {\n  return options.lowerCase\n    ? name.toLowerCase().replace(options.replace.its, options.replace.with)\n    : name.replace(options.replace.its, options.replace.with)\n}\n","import IDfy from './utils/IDfy'\n\nconst htmlTemplate = {\n  /**\n   * @param {{\n   *   code: string | undefined,\n   *   customName: string | undefined,\n   *   content: string,\n   *   isPoetry: boolean | undefined,\n   * }} details\n   * @returns {string}\n   */\n  codeBlock: ({ code, customName, content, isPoetry }) =>\n    `<pre><code${isPoetry ? ' poetry' : ''}${\n      code ? ` class=\"${isPoetry ? 'code' : 'language'}-${code}\"` : ''\n    }${customName ? ` data-customName=\"${customName}\"` : ''}>${content}</code></pre>`,\n}\n\nexport class ZeroMd extends HTMLElement {\n  get src() {\n    return this.getAttribute('src')\n  }\n\n  get path() {\n    return this.getAttribute('path')\n  }\n\n  get lang() {\n    return (\n      new URLSearchParams(window.location.search).get('lang') ||\n      this.getAttribute('lang') ||\n      this.config.lang\n    )\n  }\n\n  get code() {\n    return (\n      new URLSearchParams(window.location.search).get('code') ||\n      this.getAttribute('code') ||\n      this.config.code\n    )\n  }\n\n  get debug() {\n    return (\n      new URLSearchParams(window.location.search).get('debug') ||\n      this.getAttribute('debug') ||\n      this.config?.debug\n    )\n  }\n\n  get showDrafts() {\n    return (\n      new URLSearchParams(window.location.search).get('showDrafts') ||\n      this.getAttribute('showDrafts') ||\n      this.config?.showDrafts\n    )\n  }\n\n  set src(val) {\n    this.reflect('src', val)\n  }\n\n  set path(val) {\n    this.reflect('path', val)\n  }\n\n  set lang(val) {\n    this.reflect('lang', val)\n  }\n\n  set code(val) {\n    this.reflect('code', val)\n  }\n\n  get manualRender() {\n    return this.hasAttribute('manual-render')\n  }\n\n  set manualRender(val) {\n    this.reflect('manual-render', val)\n  }\n\n  reflect(name, val) {\n    if (val === false) {\n      this.removeAttribute(name)\n    } else {\n      this.setAttribute(name, val === true ? '' : val)\n    }\n  }\n\n  static get observedAttributes() {\n    return ['src', 'path', 'lang', 'code']\n  }\n\n  attributeChangedCallback(name, old, val) {\n    if (\n      (name === 'src' || name === 'path' || name === 'lang' || name === 'code') &&\n      this.connected &&\n      !this.manualRender &&\n      val !== old\n    ) {\n      this.render()\n    }\n  }\n\n  constructor(defaults) {\n    super()\n    this.version = '$VERSION'\n    this.config = {\n      markedUrl: 'https://cdn.jsdelivr.net/gh/markedjs/marked@2/marked.min.js',\n      prismUrl: [\n        ['https://cdn.jsdelivr.net/gh/PrismJS/prism@1/prism.min.js', 'data-manual'],\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/plugins/autoloader/prism-autoloader.min.js',\n      ],\n      cssUrls: [\n        'https://cdn.jsdelivr.net/gh/sindresorhus/github-markdown-css@4/github-markdown.min.css',\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/themes/prism.min.css',\n        'https://cdn.jsdelivr.net/gh/automician/buttons-menu-custom-element@98902f0ad3f21fa6a2f3e0d1aa75b6f478557936/build/static/css/main.e5d0f3d9.css',\n      ],\n      hostCss:\n        ':host{display:block;position:relative;contain:content;}:host([hidden]){display:none;}' +\n        `\n        .markdown-body a {\n          color: #00b7ce !important;\n        }\n        \n        .codeGroup {\n          width: auto;\n          margin: auto;\n          background-color: #F7F7F7;\n          border-radius: 10px;\n          box-shadow: 0px 5px 15px rgba(0, 0, 0, .1);\n        }\n        \n        button {\n          letter-spacing: 0.75px;\n          border: none;\n          padding: 10px;\n          # background-color: #bccbe9;\n          background-color: rgba(27,31,35,.05);\n          # color: #8e9ead;\n          color: #778796;\n          font-size: 12px;\n          font-weight: 200;\n          cursor: pointer;\n          transition: 0.5s;\n        }\n        \n        button:hover {\n          #background-color: #d5e3ff;\n          background-color: rgba(0,183,206,0.1);\n        }\n        \n        button.active {\n          background-color: rgba(27,31,35,.05);\n          border-bottom: rgb(0,183,206) 1px solid;\n        }\n        \n        .active {\n          background-color: white;\n        }\n        \n        .tab-content,.inline-content {\n          display: none;\n        }\n        \n        .tab-content.active {\n          display: block;\n        }\n        \n        .inline-content.active {\n          display: inline;\n        }\n        \n        code, pre {\n          color: #3d3d3d  !important;\n          background:0 0 !important;\n          text-shadow:0 1px #fff !important;\n          font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace !important;\n          font-size:1em   !important;\n          text-align:left !important;\n          white-space:pre !important;\n          word-spacing:normal !important;\n          word-break:normal !important;\n          word-wrap:normal !important;\n          line-height:25px !important;\n          -moz-tab-size:4 !important;\n          -o-tab-size:4 !important;\n          tab-size:4 !important;\n          -webkit-hyphens:none !important;\n          -moz-hyphens:none !important;\n          -ms-hyphens:none !important;\n          hyphens:none !important;\n        }\n        code b, pre b {\n          font-weight: 800 !important;\n          font-size: 1.1em !important;\n          color:#000 !important;\n        }\n        code em, pre em, span[style*=\"text-decoration:underline\"] {\n          font-size: 1.1em !important;\n        }\n        pre{\n          padding:1em !important;\n          margin:0 0 1em 0 !important;\n          overflow:auto !important;\n        }\n        :not(pre)>code,pre{\n          background:#F7F7F7 !important;\n        }\n        `,\n      baseUrl: '',\n      gitlab: {\n        token: null,\n        projectId: null,\n        path: null,\n        branch: 'master',\n        ...window.ZeroMdConfig.gitlab,\n      },\n      disableCodeHighlightingFor: [],\n      shortBreaksNumber: 2,\n      longBreaksNumber: 20,\n      anchorIdsToLowerCase: true,\n      indentInsideTocByPixels: 40,\n      imgBaseOld: './resources',\n      imgBaseNew: 'https://github.com/yashaka/taotaspy-resources/raw/master',\n      lang: null,\n      code: null,\n      groupCodeGroups: true,\n      pTagLang: undefined, // expect string with something like \"en-us\", \"ru\", etc...\n      ...defaults,\n      ...window.ZeroMdConfig,\n    }\n    this.cache = {}\n    this.root = this.hasAttribute('no-shadow') ? this : this.attachShadow({ mode: 'open' })\n    if (!this.constructor.ready) {\n      this.constructor.ready = Promise.all([\n        !!window.marked || this.loadScript(this.config.markedUrl),\n        !!window.Prism || this.loadScript(this.config.prismUrl),\n      ])\n    }\n    this.clicked = this.clicked.bind(this)\n    if (!this.manualRender) {\n      // Scroll to hash id after first render. However, `history.scrollRestoration` inteferes with this\n      // on refresh. It's much better to use a `setTimeout` rather than to alter the browser's behaviour.\n      this.render().then(() => setTimeout(() => this.goto(location.hash), 250))\n    }\n    this.observer = new MutationObserver(async () => {\n      this.observeChanges()\n      if (!this.manualRender) {\n        await this.render()\n      }\n    })\n    this.observeChanges()\n  }\n\n  connectedCallback() {\n    this.connected = true\n    this.fire('zero-md-connected', {}, { bubbles: false, composed: false })\n    this.waitForReady().then(() => {\n      this.fire('zero-md-ready')\n    })\n    if (this.shadowRoot) {\n      this.shadowRoot.addEventListener('click', this.clicked)\n    }\n  }\n\n  disconnectedCallback() {\n    this.connected = false\n    if (this.shadowRoot) {\n      this.shadowRoot.removeEventListener('click', this.clicked)\n    }\n  }\n\n  waitForReady() {\n    const ready =\n      this.connected ||\n      new Promise(resolve => {\n        this.addEventListener('zero-md-connected', function handler() {\n          this.removeEventListener('zero-md-connected', handler)\n          resolve()\n        })\n      })\n    return Promise.all([this.constructor.ready, ready])\n  }\n\n  // TODO: ensure this implementation is valid\n  waitForRendered() {\n    const rendered = new Promise(resolve => {\n      this.addEventListener('zero-md-rendered', function handler() {\n        this.removeEventListener('zero-md-rendered', handler)\n        resolve()\n      })\n    })\n    return Promise.all([this.constructor.ready, rendered])\n  }\n\n  fire(name, detail = {}, opts = { bubbles: true, composed: true }) {\n    if (detail.msg) {\n      console.warn(detail.msg)\n    }\n    this.dispatchEvent(\n      new CustomEvent(name, {\n        detail: { node: this, ...detail },\n        ...opts,\n      }),\n    )\n  }\n\n  tick() {\n    return new Promise(resolve => requestAnimationFrame(resolve))\n  }\n\n  // Coerce anything into an array\n  arrify(any) {\n    return any ? (Array.isArray(any) ? any : [any]) : []\n  }\n\n  // Promisify an element's onload callback\n  onload(node) {\n    return new Promise((resolve, reject) => {\n      node.onload = resolve\n      node.onerror = err => reject(err.path ? err.path[0] : err.composedPath()[0])\n    })\n  }\n\n  // Load a url or load (in order) an array of urls via <script> tags\n  loadScript(urls) {\n    return Promise.all(\n      this.arrify(urls).map(item => {\n        const [url, ...attrs] = this.arrify(item)\n        const el = document.createElement('script')\n        el.src = url\n        el.async = false\n        attrs.forEach(attr => el.setAttribute(attr, ''))\n        return this.onload(document.head.appendChild(el))\n      }),\n    )\n  }\n\n  // Scroll to selected element\n  goto(id) {\n    if (id) {\n      const el = this.root.getElementById(id.substring(1))\n      if (el) {\n        el.scrollIntoView()\n      }\n    }\n  }\n\n  // Hijack same-doc anchor hash links\n  clicked(ev) {\n    if (ev.metaKey || ev.ctrlKey || ev.altKey || ev.shiftKey || ev.defaultPrevented) {\n      return\n    }\n    const a = ev.target.closest('a')\n    if (a && a.hash && a.host === location.host && a.pathname === location.pathname) {\n      this.goto(a.hash)\n    }\n  }\n\n  dedent(str) {\n    str = str.replace(/^\\n/, '')\n    const match = str.match(/^\\s+/)\n    return match ? str.replace(new RegExp(`^${match[0]}`, 'gm'), '') : str\n  }\n\n  getBaseUrl(src) {\n    const a = document.createElement('a')\n    a.href = src\n    return a.href.substring(0, a.href.lastIndexOf('/') + 1)\n  }\n\n  // Runs Prism highlight async; falls back to sync if Web Workers throw\n  highlight(container) {\n    return new Promise(resolve => {\n      /** commented as temporal workaround of \"prisma breaks poetry html highlighting in all browsers except FF\" */\n      // const unhinted = container.querySelectorAll('pre>code:not([class*=\"language-\"])')\n      /*\n       * Prism doesn't auto-detect languages, and original zero-md version was doing this by itself\n       * but actually we don't need this magic, it nevertheless was not smart enough:)\n       * and it conflicted with current poetry implementation\n       * that lefts intentationally poetry without .language-xxxx hint\n      unhinted.forEach((n) => {\n        // Dead simple language detection :)\n        const lang = n.innerText.match(/^\\s*</)\n          ? 'markup'\n          : n.innerText.match(/^\\s*(\\$|#)/)\n          ? 'bash'\n          : 'js'\n        n.classList.add(`language-${lang}`)\n      })\n      * yet in have consistent css for all code blocks let's add language-text to all of not-hinted ones \n      * also currently we need to add it here, not in place of poetry definition\n      * because there the parsing logic depends on \"not having langauge-xxxx hint for poetries\"...\n      */\n      // unhinted.forEach(block => block.classList.add('language-text'))\n\n      this.debug &&\n        console.log(\n          '\\n===highlighting...\\n' +\n            document.querySelector('zero-md').shadowRoot.querySelector('.markdown-body').innerHTML,\n        )\n\n      try {\n        window.Prism.highlightAllUnder(container, true, resolve())\n\n        this.debug &&\n          console.log(\n            '\\n===highlighted:\\n' +\n              document.querySelector('zero-md').shadowRoot.querySelector('.markdown-body')\n                .innerHTML,\n          )\n      } catch {\n        window.Prism.highlightAllUnder(container)\n        resolve()\n\n        this.debug &&\n          console.log(\n            '\\n===highlighted:\\n' +\n              document.querySelector('zero-md').shadowRoot.querySelector('.markdown-body')\n                .innerHTML,\n          )\n      }\n    })\n  }\n\n  // Converts HTML string into node\n  makeNode(html) {\n    const tpl = document.createElement('template')\n    tpl.innerHTML = html\n    return tpl.content.firstElementChild\n  }\n\n  // Construct styles dom and return HTML string\n  buildStyles() {\n    const get = query => {\n      const node = this.querySelector(query)\n      return node ? node.innerHTML || ' ' : ''\n    }\n    const urls = this.arrify(this.config.cssUrls)\n    const html = `<div class=\"markdown-styles\"><style>${this.config.hostCss}</style>${get(\n      'template[data-merge=\"prepend\"]',\n    )}${\n      get('template:not([data-merge])') ||\n      urls.reduce((a, c) => `${a}<link rel=\"stylesheet\" href=\"${c}\">`, '')\n    }${get('template[data-merge=\"append\"]')}</div>`\n    return html\n  }\n\n  // Construct md nodes and return HTML string\n  async buildMd(opts = {}) {\n    const renderer = new window.marked.Renderer()\n    let isOriginalUnderscoredBoldDisabledByNonDefaultPoetryBoldOption = undefined\n    let tocLinks = []\n\n    /* DEFINE HOW TO GET MD */\n\n    const fetchDataFromGitlab = async fileUrl => {\n      const id = this.config.gitlab.projectId\n      const branch = this.config.gitlab.branch\n      const absolutePath = encodeURIComponent(fileUrl.trim())\n      gitlabAbsoluteUrl = `https://gitlab.com/api/v4/projects/${id}/repository/files/${absolutePath}/raw?ref=${branch}`\n\n      return fetch(gitlabAbsoluteUrl, {\n        headers: {\n          'PRIVATE-TOKEN': this.config.gitlab.token,\n        },\n      })\n    }\n\n    let isReadingFromGitlabConfigured = this.config.gitlab !== {}\n    let gitlabAbsoluteUrl = ''\n    const src = async () => {\n      if (!this.src && !this.path) {\n        return ''\n      }\n      const responce =\n        isReadingFromGitlabConfigured && this.path\n          ? await fetchDataFromGitlab(this.path)\n          : await (async () => {\n              const url = this.src.trim()\n              gitlabAbsoluteUrl = url.startsWith('http') ? url : this.config.baseUrl + url\n\n              return fetch(gitlabAbsoluteUrl)\n            })()\n\n      if (responce.ok) {\n        return await responce.text()\n      } else {\n        this.fire('zero-md-error', {\n          msg: `[zero-md] HTTP error ${responce.status} while fetching src`,\n          status: responce.status,\n          src: this.src,\n          path: this.path,\n          lang: this.lang,\n          code: this.code,\n        })\n        return ''\n      }\n    }\n    const script = () => {\n      const el = this.querySelector('script[type=\"text/markdown\"]')\n      if (!el) {\n        return ''\n      }\n      const md = el.hasAttribute('data-dedent') ? this.dedent(el.text) : el.text\n      return md\n    }\n\n    let md = (await src()) || script()\n\n    /* PROCESS MD */\n\n    const importRegex = /<!--import\\(([\\s\\S]*?)\\)-->/gim\n    const importsMatch = [...md.matchAll(importRegex)]\n\n    if (process.env.ENVIRONMENT === 'dev') {\n      if (importsMatch.length) {\n        await Promise.all(\n          importsMatch.map(async ([match, importURL]) => {\n            const response = await fetch(importURL)\n\n            if (response.ok) {\n              const importedContent = await response.text()\n              md = md.replace(match, importedContent)\n            }\n          }),\n        )\n      }\n    } else {\n      if (importsMatch.length) {\n        await Promise.all(\n          importsMatch.map(async ([match, importURL]) => {\n            const currentZeroMdPath =\n              isReadingFromGitlabConfigured && this.path ? this.path : this.src\n            const currentZeroMdFileNestingDepth = currentZeroMdPath.split('/').length - 1\n\n            let response\n            const isUrlRelative = !importURL.startsWith('http')\n            if (isUrlRelative) {\n              const importedFileNestingMatch = importURL.match(/\\.{1,2}(?=[^/]*\\/)/gim)\n\n              if (\n                (importedFileNestingMatch &&\n                  importedFileNestingMatch.length === 1 &&\n                  importedFileNestingMatch[0] === '.') ||\n                importedFileNestingMatch === null\n              ) {\n                const thisPathLastElement = this.path.split('/').pop()\n                const filePathtoReplace = importedFileNestingMatch\n                  ? importURL.split('./')[1]\n                  : importURL.split('./')[0]\n\n                importURL = this.path.replace(thisPathLastElement, filePathtoReplace)\n              }\n\n              if (\n                importedFileNestingMatch &&\n                !(importedFileNestingMatch.length === 1 && importedFileNestingMatch[0] === '.')\n              ) {\n                const importedFileNestingDepth = importedFileNestingMatch.filter(\n                  item => item === '..',\n                ).length\n\n                if (importedFileNestingDepth <= currentZeroMdFileNestingDepth) {\n                  const importURLPurePath = importURL.replace(/^(\\.\\/|\\.\\.\\/)*/, '')\n                  const importedFileFolderIndex =\n                    currentZeroMdFileNestingDepth - importedFileNestingDepth\n                  importURL = currentZeroMdPath\n                    .split('/')\n                    .slice(0, importedFileFolderIndex)\n                    .concat(importURLPurePath)\n                    .join('/')\n                } else {\n                  console.error('Provided relative path to the file does not exist')\n                  return\n                }\n              }\n\n              response = await fetchDataFromGitlab(importURL)\n            } else {\n              response = await fetch(importURL)\n            }\n\n            if (response.ok) {\n              const importedContent = await response.text()\n              md = md.replace(match, importedContent)\n            }\n          }),\n        )\n      }\n    }\n\n    const showDraftsOption = /<!---+showDrafts-+-->/i\n    if (showDraftsOption.test(md)) {\n      this.setAttribute('showDrafts', 'true')\n    }\n    const draftTags = /<draft>|<\\/draft>/gm\n    const draftedText = /<draft>(.|\\n)*?<\\/draft>/gm\n    md = this.showDrafts === 'true' ? md.replace(draftTags, '') : md.replace(draftedText, '')\n\n    const codalizedOption = new RegExp(\n      '<codalized(?: main=\"(js|ts|py|java|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)\")?\\\\/>' +\n        '|' +\n        '<!--codalized(?:\\\\s)*?\\\\(main=\"(js|ts|py|java|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)\"\\\\)-->',\n      'gim',\n    )\n    const [shouldBeCodalized, $1, $2] = [...md.matchAll(codalizedOption)].at(-1) || []\n    const defaultCodeFromMd = $1 || $2\n    this.debug && console.log('===shouldBeCodalized===\\n' + shouldBeCodalized)\n    this.debug && console.log('===defaultCodeFromMd===\\n' + defaultCodeFromMd)\n\n    const localizedOption =\n      /(?:<localized(?: main=\"(uk|ru|en)\")?\\/>)|(?:<!--localized(?:\\s)*?\\(main=\"(uk|ru|en)\"\\)-->)/gim\n    const [shouldBeLocalized, $group1, $group2] = [...md.matchAll(localizedOption)].at(-1) || []\n    const defaultLangFromMd = $group1 || $group2\n\n    this.debug && console.log('===translation===\\n')\n    const translation = /<!--((?![-\\s])\\W)(.*?)\\1([\\s\\S]*?)\\1-->/gm\n    const translate = ([_match, _delimiter, from, to]) => {\n      try {\n        md = md.replace(new RegExp('(?<!<!--\\\\W)' + from, 'gm'), to)\n      } catch (e) {\n        this.debug && console.log('===match\\n' + _match)\n        this.debug && console.log('===delimiter\\n' + _delimiter)\n        this.debug && console.log('===from\\n' + from)\n        this.debug && console.log('===to\\n' + to)\n        console.error(e)\n      }\n    }\n    ;[...md.matchAll(translation)].forEach(translate)\n    this.debug && console.log('===md after first general translation\\n' + md)\n    // next duplicated line is a crazy hack...\n    // to allow nested translations to work... (at least one-level-nested)\n    // TODO: refactor it for proper implementation\n    ;[...md.matchAll(translation)].forEach(translate)\n    this.debug && console.log('=================\\n')\n    this.debug && console.log('===md after general translations\\n' + md)\n\n    const translationPerCodeOption =\n      /<!--(?:-*)((?:js|ts|java|py|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)(?:-(?:js|ts|java|py|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml))*)((?![-])\\W)(.*?)\\2([\\s\\S]*?)\\2-->/gm\n    ;[...md.matchAll(translationPerCodeOption)].forEach(([_, perCode, __, from, to]) => {\n      if (perCode.split('-').length > 1) {\n        perCode = perCode.split('-')\n      }\n\n      if (\n        perCode instanceof Array\n          ? perCode.includes(this.code || defaultCodeFromMd)\n          : (this.code || defaultCodeFromMd) === perCode\n      ) {\n        md = md.replace(new RegExp(from, 'gm'), to)\n      }\n    })\n    const translationPerLangOption =\n      /<!--(?:-*)((?:uk|ru|en)(?:-(?:uk|ru|en))*)((?![-])\\W)(.*?)\\2([\\s\\S]*?)\\2-->/gm\n    ;[...md.matchAll(translationPerLangOption)].forEach(([_, perLang, __, from, to]) => {\n      if (perLang.split('-').length > 1) {\n        perLang = perLang.split('-')\n      }\n\n      if (\n        perLang instanceof Array\n          ? perLang.includes(this.lang || defaultLangFromMd)\n          : (this.lang || defaultLangFromMd) === perLang\n      ) {\n        md = md.replace(new RegExp(from, 'gm'), to)\n      }\n    })\n\n    this.debug && console.log('===md\\n' + md)\n\n    if (shouldBeCodalized) {\n      const codalizable =\n        /<((not-)?(?:js|ts|py|python|java|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)(?:-js|-ts|-py|-python|-java|-cs|-kt|-rb|-kt|-shell|-sh|-bash|-bat|-pwsh|-text|-md|-yaml|-json|-html|-xml)*)>([\\s\\S]*?)<\\/\\1>/gim\n      const codalize = (match, tag, inverted, content) => {\n        let candidates = inverted ? tag.split('-').slice(1) : tag.split('-')\n        candidates = candidates.map(item => (item === 'python' ? 'py' : item))\n\n        return `<span class=\"inline-content${\n          inverted\n            ? candidates.includes(this.code || defaultCodeFromMd)\n              ? ''\n              : ' active'\n            : candidates.includes(this.code || defaultCodeFromMd)\n            ? ' active'\n            : ''\n        }\" id=\"${tag}\">${content}</span>` // TODO: should we make here id value dependent on inverted?\n      }\n      while (md.match(codalizable)) {\n        md = md.replace(codalizable, codalize)\n      }\n    }\n\n    this.debug && console.log('===md after codalized\\n' + md)\n\n    if (shouldBeLocalized) {\n      const localizable = /<((not-)?(?:uk|ru|en)(?:-uk|-ru|-en)*)>([\\s\\S]*?)<\\/\\1>/gim\n      const localize = (match, tag, inverted, content) => {\n        const candidates = inverted ? tag.split('-').slice(1) : tag.split('-')\n        return inverted\n          ? candidates.includes(this.lang || defaultLangFromMd)\n            ? ''\n            : content\n          : candidates.includes(this.lang || defaultLangFromMd)\n          ? content\n          : ''\n      }\n      while (md.match(localizable)) {\n        md = md.replace(localizable, localize)\n      }\n    }\n\n    this.debug && console.log('===md after localized\\n' + md)\n\n    const tocStartLevelOption = /<!--TOC>(\\d)-->/i\n    const [, tocStartLevel] = md.match(tocStartLevelOption) || [null, 0]\n    renderer.heading = (text, level) => {\n      const [, pure, userId] = text.match(/^(.*)?\\s*{#(.*)}$/im) || [null, text]\n      const pureWithoutTagsExceptSpan = pure.replace(/<\\/?((?!span)\\w+)>/g, '')\n      const anchorIdsToLowerCase = this.config.anchorIdsToLowerCase\n      const id =\n        userId ||\n        (anchorIdsToLowerCase\n          ? IDfy(pureWithoutTagsExceptSpan)\n          : IDfy(pureWithoutTagsExceptSpan, { lowerCase: false }))\n      const pixelsNumber = this.config.indentInsideTocByPixels\n\n      if (level > tocStartLevel) {\n        const indentInsideToc = `style=\"margin-left: ${\n          pixelsNumber * (level - 1 - tocStartLevel)\n        }px\"`\n        tocLinks.push(\n          `<div ${indentInsideToc}><a href=\"#${id}\">${pureWithoutTagsExceptSpan}</a></div>`,\n        )\n      }\n\n      return `<h${level}>${encodeURI(id) === id ? '' : `<span id=\"${encodeURI(id)}\"></span>`}\n          <a id=\"${id}\" class=\"anchor\" aria-hidden=\"true\" href=\"#${id}\"></a>${pure}</h${level}>`\n    }\n\n    const imgBase = /]\\(\\.\\.?\\/resources/gim // todo: move ../resources to config\n    md = md.replace(imgBase, '](' + this.config.imgBaseNew)\n\n    const shortBreaks = /^,,,,+/gim\n    md = md.replace(shortBreaks, '<br/>'.repeat(this.config.shortBreaksNumber))\n\n    const pageBreaks = /^===$/gim\n    md = md.replace(pageBreaks, '<div style=\"page-break-after: always;\"></div>')\n\n    this.config.disableCodeHighlightingFor.forEach(lang => {\n      md = md.replace(new RegExp(`\\`\\`\\`${lang}`, 'gim'), '```')\n    })\n\n    const articleTypeExtension = /\\.(\\w+)\\.md(\\)|#)/gim\n    md = md.replace(articleTypeExtension, `-$1.md$2`)\n\n    // todo: fix to skip links that start with http\n    const mdExtensions = /\\.md\\)/gim\n    md = md.replace(mdExtensions, '-md)')\n\n    const mdExtensionsWithId = /\\.md#/gim\n    md = md.replace(mdExtensionsWithId, '-md#')\n\n    const poetryBoldOption = /<!--(.+?)poetryBold(.+?)-->/gi\n    const [, poetryBoldStart, poetryBoldEnd] = [...md.matchAll(poetryBoldOption)].at(-1) || [\n      null,\n      '__',\n      '__',\n    ]\n\n    const tabNameOption = /<!--(.+)tabNameBrackets(.+)-->/i\n    const [, tabNameStart, tabNameEnd] = md.match(tabNameOption) || [null, '\"', '\"']\n\n    const poetryBoldOptionRule = [\n      new RegExp(\n        `${poetryBoldStart}(?!${poetryBoldStart})(.*?)${poetryBoldEnd}(?!${poetryBoldEnd})`,\n        'gmi',\n      ),\n      '<b>$1</b>',\n    ]\n    // todo: change to ```poetry ... ``` style\n    const poetries =\n      /---[a-z]*\\n([\\s\\S]*?)\\n---/gim /* TODO: should have same abount of groups as backTickPoetries\n      or should be replaced with backTickPoetries completely, i.e. removed\n    */\n    const poetryRulesExceptBold = [\n      [/(_)___(?!\\1)(.*?)____(?!\\1)/gim, '<span style=\"text-decoration:underline\">$2</span>'], //underlined\n      [/(_)__(?!\\1)(.*?)___(?!\\1)/gim, '<em>$2</em>'], //emphasis (aka \"italic\")\n\n      // [/^(?!.*\\/\\*.*$).*(\\*)(.*?)\\1/gmi,      '<em>$2</em>'], //emphasis\n      // TODO: fix: does not work for lines: ... * ... * ... /* ... */ ...\n      // read for more info:\n      //    https://stackoverflow.com/questions/7376238/javascript-regex-look-behind-alternative\n    ]\n    isOriginalUnderscoredBoldDisabledByNonDefaultPoetryBoldOption = poetryBoldStart !== '__'\n    const backTickPoetries = /```poetry(?::( .+))?(?:\\n|\\r\\n)([\\s\\S]*?)\\n```/gim\n    const processPoetry = rules => (match, info, content) => {\n      // const titles = info.split(/\\s+/)\n      // const maybeCodeOrCustomNameOrBoth =\n      // /(?:^|\\s+)(js|ts|java|py|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)?(?:\"(.+?)\")?\"/g\n      const maybeCodeOrCustomNameOrBoth = new RegExp(\n        '(?:^|\\\\s+)' +\n          '(js|ts|java|py|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)?' +\n          `(?:${tabNameStart}(.+?)${tabNameEnd})?`,\n        'g',\n      )\n\n      const maybeCodeOrCustomNameOrBothPairs = [\n        ...(info?.trim().matchAll(maybeCodeOrCustomNameOrBoth) ?? []),\n      ].map(matched => ({ maybeCode: matched[1], maybeCustomName: matched[2] }))\n      let res = content\n\n      // TODO: encode all html elements definition tokens in poetry content with &lt;, &gt;, and &quot;\n      res = res.replace(/</gim, '&lt;')\n      res = res.replace(/>/gim, '&gt;')\n      res = res.replace(/\"/gim, '&quot;')\n\n      for (const rule of rules) {\n        res = res.replace(rule[0], rule[1])\n      }\n\n      if (isOriginalUnderscoredBoldDisabledByNonDefaultPoetryBoldOption) {\n        // then we should totally disable original __ and **\n        // in md processing (both by us and marked.js)\n        // by encoding it ...\n        res = res.replace(/(_)_(?!\\1)(.*?)__(?!\\1)/gim, '‡‡‡$2‡‡‡') // to encode original __\n        if (poetryBoldStart !== '\\\\*\\\\*') {\n          res = res.replace(/(\\*)\\*(?!\\1)(.*?)\\*\\*(?!\\1)/gim, '•••$2•••') // to encode original __\n        }\n        // then decode it later once md is processed and we get html...\n      }\n\n      const boldRules = [\n        poetryBoldOptionRule, //bold1\n        [/(\\*)\\*(?!\\1)(.*?)\\*\\*(?!\\1)/gim, '<b>$2</b>'], //bold2\n      ]\n\n      for (const rule of boldRules) {\n        res = res.replace(rule[0], rule[1])\n      }\n\n      const wrapped = maybeCodeOrCustomNameOrBothPairs.length\n        ? maybeCodeOrCustomNameOrBothPairs\n            .map(({ maybeCode, maybeCustomName }) =>\n              htmlTemplate.codeBlock({\n                code: maybeCode,\n                content: res,\n                customName: maybeCustomName,\n                isPoetry: true,\n              }),\n            )\n            // if somebody passed more than one pair in info,\n            // then we clone content into same amount of poetries\n            .join('\\n')\n        : htmlTemplate.codeBlock({ code: 'text', content: res, isPoetry: true })\n\n      return wrapped\n    }\n\n    md = md.replace(poetries, processPoetry(poetryRulesExceptBold))\n    md = md.replace(backTickPoetries, processPoetry(poetryRulesExceptBold))\n\n    const multiCodeBlocks = /```((?:[a-z]+)(?: [a-z]+)+)(?:\\n|\\r\\n)([\\s\\S]*?)\\n```/gim\n    md = md.replace(multiCodeBlocks, (match, codes, content) => {\n      return codes\n        .split(/\\s+/)\n        .map(code => `\\`\\`\\`${code}\\n${content}\\n\\`\\`\\``)\n        .join('\\n')\n    })\n\n    const multiTabsWithCustomNamesCodeBlocks =\n      /```\\b(?!poetry\\b)([a-z]+)(?:: (.+))(?:\\n|\\r\\n)([\\s\\S]*?)\\n```/gim\n    md = md.replace(multiTabsWithCustomNamesCodeBlocks, (match, code, info, content) => {\n      const customNameAndMaybeCode = [\n        ...info.matchAll(\n          new RegExp(\n            '(js|ts|java|py|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)?' +\n              tabNameStart +\n              '(.+?)' +\n              tabNameEnd,\n            'gim',\n          ),\n        ),\n      ].map(matched => ({ maybeCode: matched[1], customName: matched[2] }))\n      return customNameAndMaybeCode\n        .map(({ maybeCode, customName }) =>\n          htmlTemplate.codeBlock({ content, customName, code: maybeCode ?? code }),\n        )\n        .join('\\n')\n    })\n\n    /* GET HTML */\n\n    this.debug && console.log('===md before final processing via marked.js\\n' + md)\n\n    let html = window.marked(md, {\n      baseUrl: this.getBaseUrl(window.location.href),\n      renderer,\n      ...opts,\n    })\n\n    /* PROCESS HTML */\n\n    this.debug && console.log('===html before processing\\n' + html)\n\n    /* long breaks moved to be processed after md processing\n     * as a draft workaround to disable longBreaks processing inside code blocks\n     */\n    // const longBreaks = /^====+/gim\n    const longBreakInParagrapth = /<p>====+<\\/p>/gim\n    html = html.replace(longBreakInParagrapth, '<br/>'.repeat(this.config.longBreaksNumber))\n    const longBreakAtParagraphEnding = /^====+<\\/p>/gim\n    html = html.replace(\n      longBreakAtParagraphEnding,\n      '<br/>'.repeat(this.config.longBreaksNumber) + '</p>',\n    )\n\n    // decode previously decoded\n    if (isOriginalUnderscoredBoldDisabledByNonDefaultPoetryBoldOption) {\n      html = html.replace(/‡‡‡/gim, '__')\n      html = html.replace(/•••/gim, '**')\n    }\n\n    const tocMarker = /\\[toc\\]/i\n    const toc = `<div class=\"toc\">${tocLinks.join('')}</div>`\n    html = html.replace(tocMarker, toc)\n\n    const codeGroups = /<p>(:::+)(manual)?<\\/p>([\\s\\S]*?)<p>\\1<\\/p>/gim\n    const processCodeGroup = (match, _, manual, items) => {\n      const itemMarker =\n        /<pre><code( poetry)?(?: class=\"(?:language|code)-(\\w+)\")?( data-customName=\"(.+)\")?.*?>([\\s\\S]*?)<\\/code><\\/pre>/gim\n\n      // const contentAndMaybeCodeOrCustomNameOrAll = [...items.matchAll(itemMarker)].map(\n      //   (matched) => ({\n      //     maybeCode: matched[2],\n      //     maybeCustomName: matched[4],\n      //     content: matched[0],\n      //   }),\n      // )\n\n      let [itemsContent, itemsTitles] = [...items.matchAll(itemMarker)].reduce(\n        ([content, titles], [match, _, code, ___, customName, _____]) => {\n          const title = customName ? [code, customName] : [code]\n\n          return [\n            [...content, match],\n            [...titles, title],\n          ]\n        },\n        [[], []],\n      )\n\n      let processedCodes = []\n      return `\n          <div class=\"codeGroup\">\n            <div class=\"buttonWrapper\">\n              ${itemsTitles\n                .map((title, index) => {\n                  // TODO: name it and find good proper name\n\n                  const code = title[0]\n                  const customName = title[1]\n\n                  const html = `<button class=\"tab-button${\n                    manual\n                      ? index === 0\n                        ? ' active'\n                        : ''\n                      : (\n                          this.code\n                            ? this.code === code && !processedCodes.includes(code)\n                            : index === 0\n                        )\n                      ? ' active'\n                      : ''\n                  }\"${\n                    code || customName\n                      ? ' data-id=\"' + IDfy(customName ? code + '_' + customName : code) + '\"'\n                      : ''\n                  }>${customName ?? code ?? '__'}</button>`\n\n                  processedCodes.push(code)\n\n                  return html\n                })\n                .join('\\n')}\n            </div>\n            <div class=\"contentWrapper\">\n              ${itemsContent\n                .map((item, index) => {\n                  const title = itemsTitles[index]\n                  const code = title[0]\n                  const customName = title[1]\n                  if (index === 0) {\n                    processedCodes = [] // TODO: remove this mutation from lambda for map (such lambda should be pure, i.e. not mutating anything from outer scope)\n                  }\n\n                  const html = `<div class=\"tab-content${\n                    manual\n                      ? index === 0\n                        ? ' active'\n                        : ''\n                      : (\n                          this.code\n                            ? this.code === code && !processedCodes.includes(code)\n                            : index === 0\n                        )\n                      ? ' active'\n                      : ''\n                  }\"${\n                    code || customName\n                      ? ' id=\"' + IDfy(customName ? code + '_' + customName : code) + '\"'\n                      : ''\n                  }>${item}</div>`\n\n                  processedCodes.push(code)\n\n                  return html\n                })\n                .join('\\n')}\n            </div>\n          </div>\n          `.trim()\n    }\n\n    html = html.replace(codeGroups, processCodeGroup)\n\n    const languageJsMarker = /<pre><code class=\"language-(js|javascript)\"/gim\n    html = html.replace(languageJsMarker, '<pre><code class=\"language-typescript\"')\n\n    this.debug && console.log('===html after processing\\n' + html)\n\n    return `<div class=\"markdown-body${\n      opts.classes ? this.arrify(opts.classes).reduce((a, c) => `${a} ${c}`, ' ') : ''\n    }\">${html}</div>`\n  }\n\n  // Insert or replace HTML styles string into DOM and wait for links to load\n  async stampStyles(html) {\n    const node = this.makeNode(html)\n    const links = [...node.querySelectorAll('link[rel=\"stylesheet\"]')]\n    const target = [...this.root.children].find(n => n.classList.contains('markdown-styles'))\n    if (target) {\n      target.replaceWith(node)\n    } else {\n      this.root.prepend(node)\n    }\n    await Promise.all(links.map(l => this.onload(l))).catch(err => {\n      this.fire('zero-md-error', {\n        msg: '[zero-md] An external stylesheet failed to load',\n        status: undefined,\n        src: err.href,\n      })\n    })\n  }\n\n  // Insert or replace HTML body string into DOM and returns the node\n  stampBody(html) {\n    const node = this.makeNode(html)\n    const target = [...this.root.children].find(n => n.classList.contains('markdown-body'))\n    if (target) {\n      target.replaceWith(node)\n    } else {\n      this.root.append(node)\n    }\n    return node\n  }\n\n  // Start observing for changes in root, templates and scripts\n  observeChanges() {\n    this.observer.observe(this, { childList: true })\n    this.querySelectorAll('template,script[type=\"text/markdown\"]').forEach(n => {\n      this.observer.observe(n.content || n, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        characterData: true,\n      })\n    })\n  }\n\n  async render(opts = {}) {\n    await this.waitForReady()\n    const stamped = {}\n    const pending = this.buildMd(opts)\n    const css = this.buildStyles()\n    if (css !== this.cache.styles) {\n      this.cache.styles = css\n      await this.stampStyles(css)\n      stamped.styles = true\n      await this.tick()\n    }\n    const md = await pending\n    this.debug && console.log('\\n===built md:\\n' + md)\n    if (md !== this.cache.body) {\n      this.cache.body = md\n      const node = this.stampBody(md)\n\n      /* PROCESS CODE GROUP - START */\n      const tabsWrappers = node.querySelectorAll('.codeGroup')\n      tabsWrappers.forEach(tabsWrapper => {\n        function hideCodeGroupWithNoActiveTab() {\n          node.querySelectorAll('.codeGroup').forEach(codeGroup => {\n            const activeTab = codeGroup.querySelector('.tab-button.active')\n            codeGroup.style.display = activeTab ? 'block' : 'none'\n          })\n        }\n\n        function setActiveTabInAllCodeGroups(activeValue) {\n          node.querySelectorAll('.codeGroup .tab-button').forEach(tabButton => {\n            tabButton.dataset.id === activeValue\n              ? tabButton.classList.add('active')\n              : tabButton.classList.remove('active')\n          })\n          node.querySelectorAll(`.tab-content,.inline-content`).forEach(content => {\n            content.id === activeValue\n              ? content.classList.add('active')\n              : content.classList.remove('active')\n          })\n        }\n\n        const codalizedOption =\n          /<codalized(?: main=\"(js|ts|py|java|cs|clj|clojure|kt|rb|kt|shell|sh|bash|bat|pwsh|text|md|yaml|json|html|xml)\")?\\/>/gim\n        const [shouldBeCodalized, defaultCodeFromMd] =\n          [...md.matchAll(codalizedOption)].at(-1) || []\n        const codeValueFromAttributesSetByButtons = document\n          .querySelector('zero-md')\n          .getAttribute('code')\n\n        const urlParams = new URLSearchParams(window.location.search)\n        if (!urlParams.get('code')) {\n          if (shouldBeCodalized && !codeValueFromAttributesSetByButtons) {\n            setActiveTabInAllCodeGroups(this.code || defaultCodeFromMd)\n          }\n        }\n\n        tabsWrapper.onclick = e => {\n          const element = e.target\n          const newActiveContentId = element.dataset.id\n          const isElementANonActiveTabButton =\n            !!newActiveContentId && !element.classList.contains('active')\n          if (isElementANonActiveTabButton) {\n            if (this.config.groupCodeGroups) {\n              setActiveTabInAllCodeGroups(newActiveContentId)\n              hideCodeGroupWithNoActiveTab()\n            } else {\n              const buttonsWrapper = element.parentElement\n              buttonsWrapper.querySelector('.tab-button.active').classList.remove('active')\n              element.classList.add('active')\n\n              const wrapper = buttonsWrapper.parentElement\n              const contents = wrapper.querySelectorAll('.tab-content')\n              contents.forEach(content => {\n                content.classList.remove('active')\n              })\n              wrapper.querySelector(`#${newActiveContentId}`).classList.add('active')\n            }\n          }\n        }\n\n        hideCodeGroupWithNoActiveTab()\n      })\n      /* PROCESS CODE GROUP - END */\n      stamped.body = true\n      await this.highlight(node)\n    }\n\n    this.fire('zero-md-rendered', { stamped })\n  }\n}\ncustomElements.define('zero-md', ZeroMd)\n"],"names":["notAUnicodeWord","IDfy","name","options","arguments","length","undefined","lowerCase","replace","its","with","toLowerCase","htmlTemplate","_ref","code","customName","content","isPoetry","concat","ZeroMd","_HTMLElement","_inherits","_render","_stampStyles","_buildMd","_super","defaults","_this","_classCallCheck","call","this","version","config","_objectSpread","markedUrl","prismUrl","cssUrls","hostCss","baseUrl","gitlab","token","projectId","path","branch","window","ZeroMdConfig","disableCodeHighlightingFor","shortBreaksNumber","longBreaksNumber","anchorIdsToLowerCase","indentInsideTocByPixels","imgBaseOld","imgBaseNew","lang","groupCodeGroups","pTagLang","cache","root","hasAttribute","_assertThisInitialized","attachShadow","mode","constructor","ready","Promise","all","marked","loadScript","Prism","clicked","bind","manualRender","render","then","setTimeout","goto","location","hash","observer","MutationObserver","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","observeChanges","stop","key","get","getAttribute","set","val","reflect","URLSearchParams","search","_this$config","debug","_this$config2","showDrafts","value","removeAttribute","setAttribute","old","connected","_this2","fire","bubbles","composed","waitForReady","shadowRoot","addEventListener","removeEventListener","_this3","resolve","handler","_this4","rendered","detail","opts","msg","console","warn","dispatchEvent","CustomEvent","node","requestAnimationFrame","any","Array","isArray","reject","onload","onerror","err","composedPath","urls","_this5","arrify","map","item","_this5$arrify","_this5$arrify2","url","attrs","slice","el","document","createElement","src","async","forEach","attr","head","appendChild","id","getElementById","substring","scrollIntoView","ev","metaKey","ctrlKey","altKey","shiftKey","defaultPrevented","a","target","closest","host","pathname","str","match","RegExp","href","lastIndexOf","container","_this6","log","querySelector","innerHTML","highlightAllUnder","_unused","html","tpl","firstElementChild","_this7","query","reduce","c","_callee7","renderer","isOriginalUnderscoredBoldDisabledByNonDefaultPoetryBoldOption","tocLinks","fetchDataFromGitlab","isReadingFromGitlabConfigured","gitlabAbsoluteUrl","script","md","importRegex","importsMatch","draftTags","draftedText","codalizedOption","_ref12","_ref13","shouldBeCodalized","$1","$2","defaultCodeFromMd","localizedOption","_ref14","_ref15","shouldBeLocalized","$group1","$group2","defaultLangFromMd","translation","translate","translationPerCodeOption","translationPerLangOption","codalizable","codalize","localizable","localize","tocStartLevelOption","_ref22","_ref23","tocStartLevel","imgBase","shortBreaks","pageBreaks","articleTypeExtension","mdExtensions","mdExtensionsWithId","poetryBoldOption","_ref26","_ref27","poetryBoldStart","poetryBoldEnd","tabNameOption","_ref28","_ref29","tabNameStart","tabNameEnd","poetryBoldOptionRule","poetries","poetryRulesExceptBold","backTickPoetries","processPoetry","multiCodeBlocks","multiTabsWithCustomNamesCodeBlocks","longBreakInParagrapth","longBreakAtParagraphEnding","tocMarker","toc","codeGroups","processCodeGroup","languageJsMarker","_this8","_args7","_context7","Renderer","_ref3","_callee2","fileUrl","absolutePath","_context2","encodeURIComponent","trim","abrupt","fetch","headers","_x","apply","_ref4","_callee4","responce","_context4","t0","sent","_callee3","_context3","startsWith","ok","text","status","dedent","_toConsumableArray","matchAll","_ref7","_callee5","_ref6","_ref8","importURL","response","importedContent","_context5","_slicedToArray","_x2","_ref10","_callee6","_ref9","_ref11","currentZeroMdPath","currentZeroMdFileNestingDepth","importedFileNestingMatch","thisPathLastElement","filePathtoReplace","importedFileNestingDepth","importURLPurePath","importedFileFolderIndex","_context6","split","pop","filter","join","error","_x3","test","at","_ref16","_ref17","_match","_delimiter","from","to","e","_ref18","_ref19","perCode","includes","_ref20","_ref21","perLang","tag","inverted","candidates","heading","level","_ref25","pure","userId","pureWithoutTagsExceptSpan","pixelsNumber","indentInsideToc","push","encodeURI","repeat","rules","info","_info$trim$matchAll","maybeCodeOrCustomNameOrBoth","maybeCodeOrCustomNameOrBothPairs","matched","maybeCode","maybeCustomName","res","_step","_iterator","_createForOfIteratorHelper","s","n","done","rule","f","_i","_boldRules","_ref30","codes","_ref31","getBaseUrl","_","manual","items","_reduce","_ref32","_ref33","_ref34","titles","_ref35","title","_reduce2","itemsContent","itemsTitles","processedCodes","index","_ref36","classes","_callee8","links","_this9","_context8","makeNode","querySelectorAll","children","find","classList","contains","replaceWith","prepend","l","catch","_x4","append","_this10","observe","childList","subtree","attributes","characterData","_callee9","stamped","pending","css","_this11","_args9","_context9","buildMd","buildStyles","styles","stampStyles","tick","body","stampBody","tabsWrapper","hideCodeGroupWithNoActiveTab","codeGroup","activeTab","style","display","setActiveTabInAllCodeGroups","activeValue","tabButton","dataset","add","remove","_ref38","codeValueFromAttributesSetByButtons","onclick","element","newActiveContentId","buttonsWrapper","parentElement","wrapper","highlight","_wrapNativeSuper","HTMLElement","customElements","define"],"mappings":"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"}